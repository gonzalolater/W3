# Proof Of Stake

设计原则与原理，共识算法选择，安全模型、激励模型、随机抽样、洗牌算法、按照时隔的洗牌算法、委员会选举 分叉选择规则、序列化编码算法、验证者生命周期、分叉机制 分叉数据结构包含之前的分叉标识符、当前的分叉标识符和分叉时点。分叉标识符会影响当前区块高度下的消息签名。 分叉需要在指定的时点，将分叉的标识符更新成最新的分叉标识符。 状态确定性和最终性，区块链是资产所有权的注册系统，状态的最终确定性具有一定的概率性，是系统不被攻破的概率。

## LodeStar

The state could be initialized from anchor state, database, execution layer. The provider pattern is used for ethereum execution layer. The type and interface keywords are used. The value list of synchronization state is stalled, synchronizing finalization, synchronizing head, synchronized. The range of slots is indicated by start slot and end slot. 

The question mark can indicate the optional property of the field. The export statement is used to export functions, objects, or primitives from a module, making them available for use in other modules. The asterisk in the export statement signifies that you are exporting all exports from a module.  The three dot operator is known as the spread operator or rest operator. It is used to expand an iterable object into its individual elements. The rest operator is used in function parameter to gather the remaining arguments into an array. There are several utility types that help manipulate and transform types. They are partial, require, readonly, record, pick, omit, exclude, extract, non nullable, return type, instance type, and this type.

The lodestar is a TypeScript implementation of Ethereum consensus specification. It includes command line tool, beacon node client, validator client and other utilities. When the block is coming, the block will be processed by the chain and fork choice. There is block processor between the chain and fork choice.

## Programming language

Creating a programming language involves several key steps: define the grammar, build the compiler front end, build the compiler back end, implement language features, develop supporting tools. The grammar defines things like keywords, operators, variable, data types, control flow statement,  and the overall structure of valid program. Creating a domain specific language involves the following key steps: identify the domain, design the syntax, implement domain specific language. 

## Ethereum Specification

分叉选择软件包提供查询区块的头信息，分叉选择存储对象的更新是事件机制触发，触发的因子有时间、区块、投票和惩罚。 The double colon need to be used to specify the type parameter when invoking generic methods. The double colon severs several important purposes, primarily related to namespace resolution and access control. The state of object is changed when its mutable methods are called with passing-in values. 

Blocks are considered expression, which means they can return an value. The value of the last expression in the block is what gets returned. The return keyword is not needed, the last expression is automatically returned. Since blocks are evaluated to values, the result of block can be assigned to a variable. 

The command name will match the client builder through the command line application system. The client builder will build all the necessary services and start them. The last service is the network service. During this process, the configuration is used to provide the values. The dependent object can be passed as value or atomic reference so that the state can be synchronized between the objects. 


